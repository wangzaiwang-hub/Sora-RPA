# 视频加载拦截功能

## 功能说明

为了减少网络占用和提高抓包效率，插件现在会自动阻止视频内容的加载，只保留静态展示图（缩略图）。

## 工作原理

插件通过以下方式拦截视频加载：

1. **拦截网络请求**
   - 拦截所有 `fetch` 请求中的视频资源（.mp4, .webm, .m3u8 等）
   - 拦截所有 `XMLHttpRequest` 请求中的视频资源
   - 返回空响应，避免下载视频内容

2. **拦截 HTML 视频标签**
   - 禁止 `<video>` 标签的自动播放（`autoplay = false`）
   - 禁止视频预加载（`preload = 'none'`）
   - 清空视频源（`src = ''`）
   - 移除所有 `<source>` 子标签

3. **监听 DOM 变化**
   - 实时监听页面上新添加的 `<video>` 标签
   - 自动对新标签应用拦截规则

## 拦截的资源类型

- 视频文件：`.mp4`, `.webm`, `.m3u8`, `.ts`, `.mov`
- 视频流：包含 `video`, `stream`, `media` 关键字的 URL
- CDN 视频：Sora 视频 CDN 的资源
- Blob URL：`blob:http` 开头的视频资源

## 配置

在 `plug-renwu/injected.js` 文件中，可以通过修改配置来启用/禁用视频拦截：

```javascript
// 🚫 禁止视频加载的配置
const BLOCK_VIDEO_LOADING = true; // 设置为 true 禁止视频加载，false 允许加载
```

## 效果

- ✅ 只加载视频的缩略图和元数据
- ✅ 大幅减少网络带宽占用
- ✅ 提高页面加载速度
- ✅ 不影响视频信息的抓取（标题、描述、链接等）
- ✅ 控制台会显示 `🚫 已阻止视频加载` 的日志

## 注意事项

1. 视频拦截只影响浏览器中的显示，不影响数据抓取
2. 所有视频的元数据（标题、描述、链接、缩略图等）仍然会被正常抓取
3. 如果需要查看视频内容，可以：
   - 临时禁用插件
   - 或将 `BLOCK_VIDEO_LOADING` 设置为 `false`
4. 修改配置后需要重新加载插件才能生效

## 测试

重新加载插件后，访问 Sora 页面，在控制台中应该能看到：

```
📡 页面拦截器已注入
🚫 启用视频标签拦截...
✅ 视频标签拦截已启用
✅ 页面拦截器设置完成
🚫 已阻止视频加载: https://...video.mp4
🚫 已阻止 video 标签加载
```

## 故障排除

如果视频仍在加载：

1. 确认 `BLOCK_VIDEO_LOADING` 设置为 `true`
2. 在 Chrome 扩展管理页面重新加载插件
3. 刷新 Sora 页面（Ctrl+R 或 F5）
4. 检查控制台是否有拦截日志
